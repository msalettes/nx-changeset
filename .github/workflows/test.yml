name: test

on:
  pull_request:
    branches:
      - "**"
  push:
    branches:
      - "**"
  workflow_dispatch:

jobs:
  test:
    name: Test
    runs-on: ubuntu-latest
    steps:
      - name: Get branch name
        run: |
            echo "GITHUB_REF: ${GITHUB_REF##*/}";
            echo "github.event.workflow_run.head_sha: ${{ github.event.workflow_run.head_sha }}";
            echo "github.event.workflow_run.head_ref: ${{ github.event.workflow_run.head_ref }}";
            echo "github.event.pull_request.head.sha: ${{ github.event.pull_request.head.sha }}";
            echo "github.ref: ${{ github.ref }}";
            echo "github.sha: ${{ github.sha }}";

      - name: Checkout Rep
        uses: actions/checkout@v3
        with:
          ref: ${{ github.sha }}

      - name: Test file
        id: isFileExist
        run: |
          echo "::set-output name=package4Exists::$(test -f './packages/package4/package.json' && echo 'true' || echo  'false')";
          echo "::set-output name=package5Exists::$(test -f './packages/package5/package.json '&& echo 'true' || echo  'false')";

      - name: if package4 exists
        if: ${{ steps.isFileExist.outputs.package4Exists == 'true' }}
        run: |
          echo "package4Exists";

      - name: if package5 exists
        if: ${{ steps.isFileExist.outputs.package5Exists == 'true' }}
        run: |
          echo "package5Exists";
